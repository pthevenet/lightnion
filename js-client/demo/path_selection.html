<html>

<head>
  <script src="lightnion.bundle.js"></script>
  <meta charset="UTF-8">
</head>

<body>
  <p id="status"></p>
  <p id="guard">Guard: waiting...</p>
  <p id="middle">Middle: waiting...</p>
  <p id="exit">Exit: waiting...</p>
  <script>

    //DON'T FORGET TO CHANGE DESCRIPTORS
    lnn.open('localhost', 4990,
      end => {
        if (end.state != lnn.state.success) return
        document.getElementById('status').textContent = "Chanel opened"

        lnn.get.consensus(end,
          end => {
            document.getElementById('status').textContent = "Consensus downloaded"

            //build a hashmap of descriptor where the keys are the identity
            let descriptorsMap = {}

            for (let descriptor of descriptors) {
              let identity = descriptor['router'].identity
              descriptorsMap[identity] = descriptor
            }

            //pre-process consensus by filering the routers that do not obey
            //the minimal constraints
            let consensus = end.consensus['routers'].filter(r => !obeyMinimalConstraints(r, descriptorsMap))

            //path selection
            let exitDescriptor = chooseGoodExit(consensus, descriptorsMap)
            document.getElementById('exit').textContent = "Exit: " + exitDescriptor['router'].nickname

            let guardDecriptor = chooseGoodGuard(consensus, exitDescriptor, descriptorsMap)
            document.getElementById('guard').textContent = "Guard: " + guardDecriptor['router'].nickname

            let middleDecriptor = chooseGoodMiddle(consensus, guardDecriptor, exitDescriptor, descriptorsMap)
            document.getElementById('middle').textContent = "Middle: " + middleDecriptor['router'].nickname



          }, error)
      }, error)

    function error(endpoint) {
      document.getElementById('status').textContent = "Something went wrong"
    }

    //--------------------------UTILS---------------------------------------
     
    function obeyMinimalConstraints(router, descriptorsMap) {
      let des = descriptorsMap[router['identity']]
      let flags = router['flags']

      if (!flags.includes("Valid")) return false
      if (!flags.includes("Running")) return false
      if (!router['version'].startsWith("TOR 0.3.")) return false
      if (router['digest'] !== des['digest']) return false
      if (des['identity']['type'] !== 'ed25519') return false

      return true
    }

    function weightedRandomChoice(candidates, descriptorsMap) {
      let total = candidates.reduce((acc, r) => acc + descriptorsMap[r['identity']]['bandwidth']['avg'],0)
      let r = random(total)
      let upto = 0

      for (let router of candidates) {
        let des = descriptorsMap[router['identity']]
        let bandwidth = des['bandwidth']['avg']

        if (upto + bandwidth >= r) return des
        else upto += bandwidth
      }

    }

    function inSame16Subnet(des1, des2 ) {
      let addr1 = des1['router']['address'].split(".")
      let addr2 = des2['router']['address'].split(".")

      return addr1[0] === addr2[0] && addr1[1] === addr2[1]
    }

    function inSameFamily(des1, des2) {
      if (des1['family'] != undefined && des2['family'] != undefined) {
        for (let fam of des1['family']) {
          if (des2['family'].includes(fam)) return true
        }
      }

      return false
    }

    function random(max) {
      return Math.random() * max
    }

    //------------------------------ EXIT ---------------------------------

    function chooseGoodExit(consensus, descriptorsMap) {
      let candidates = consensus.filter(isGoodExit)
      return weightedRandomChoice(candidates, descriptorsMap)
    }

    function isGoodExit(router) {
      let flags = router['flags']
      if (!flags.includes('Exit') || flags.includes('BadExit')) return false
      if (router['exit-policy']['type'] !== 'accept') return false

      return true

    }

    //---------------------------GUARD-------------------------------------
    function chooseGoodGuard(consensus, exitDescriptor, descriptorsMap) {
      let candidates = consensus.filter(r => isGoodGuard(r, exitDescriptor, descriptorsMap))
      return weightedRandomChoice(candidates, descriptorsMap)
    }

    function isGoodGuard(router, exitDescriptor, descriptorsMap){
      let flags = router['flags']
      let des = descriptorsMap[router.identity]

      if(!flags.includes('Guard')) return false
      if(!flags.includes('Stable')) return false
      if(!flags.includes('V2Dir')) return false
      //if(inSame16Subnet(des, exitDescriptor) return false
      if(inSameFamily(des, exitDescriptor)) return false

      return true
    }

    //------------------------MIDDLE-------------------------------------------
    function chooseGoodMiddle(consensus, guardDecriptor, exitDescriptor, descriptorsMap){
      let candidates = consensus.filter(r => isGoodMiddle(r, guardDecriptor, exitDescriptor, descriptorsMap))
      return weightedRandomChoice(candidates, descriptorsMap)
    }

    function isGoodMiddle(router, guardDecriptor, exitDescriptor, descriptorsMap){
      let des = descriptorsMap[router.identity]
      //if(inSame16Subnet(des, guardDecriptor)) return false
      //if(inSame16Subnet(des, exitDescriptor)) return false
      if(inSameFamily(des, guardDecriptor)) return false
      if(inSameFamily(des, exitDescriptor)) return false

      return true
    }

    let descriptors = [{
      "digest": "hPHM9cwd1sgk0dqZIPOD4bLUMaM",
      "router": {
        "nickname": "test005r",
        "address": "127.0.0.1",
        "orport": 5005,
        "socksport": 0,
        "dirport": 7005,
        "identity": "R6mNjr7yq6E/j87gDhRLGe/b6Fw"
      },
      "identity": {
        "type": "ed25519",
        "cert": "AQQABopcAQfQ2kbKSN/pCyms/5l2+E3ETLUkUl0GHS1Z99NDoUhFAQAgBACw1kn0rxBE2nUuovyJXjbb0Vs5GRF4/jCqKwpfHnzBCz8ZzWlPPVxW0LxctmTRYyAcfouyqr2FaL3/JuL7xEPPoQZS8/YU2y6UyrODBASi2X/ul3Khtfz161eOGICy3gI=",
        "master-key": "sNZJ9K8QRNp1LqL8iV4229FbORkReP4wqisKXx58wQs"
      },
      "platform": "Tor 0.3.4.8 on Linux",
      "proto": {
        "Cons": [1, 2],
        "Desc": [1, 2],
        "DirCache": [1, 2],
        "HSDir": [1, 2],
        "HSIntro": [3, 4],
        "HSRend": [1, 2],
        "Link": [1, 2, 3, 4, 5],
        "LinkAuth": [1, 3],
        "Microdesc": [1, 2],
        "Relay": [1, 2]
      },
      "published": {
        "date": "2018-10-25",
        "time": "19:41:28",
        "stamp": 1540496488.0
      },
      "fingerprint": "47A9 8D8E BEF2 ABA1 3F8F CEE0 0E14 4B19 EFDB E85C",
      "uptime": 0,
      "bandwidth": {
        "avg": 1073741824,
        "burst": 1073741824,
        "observed": 0
      },
      "extra-info-digest": {
        "sha1": "C539C1689309BAB76CE5CB936D1027292DA9E472",
        "sha256": "ecMuOs5iw0G/AxFKcInjDFg0ZnZSUbz1u24DSnvcM+g"
      },
      "onion-key": "MIGJAoGBAKyaqW0cDjE0qT/rrOwkwdPPokXd3SRZ4GsBINxmHppk2i80bCBFBBeKL/VaW9QfwHh5R6a5N4h0eRBQTWvFx8ZL3M6gKrlsyYJxR/t3dVvc7bk+h1cIYQuFfh7+fjeqOj/r8CZuUX6o51E9AyGAI9SzY17AsSLUd+43psWxzPA9AgMBAAE=",
      "signing-key": "MIGJAoGBALBEdZHPn906PlhtFTXiWWrEFGxvEvo47YjEIVjTGswgirI8zliqaVkucT3k6w+RiQ16UhM1nQ+1urL21DZyG90Y6clnWMRSMOaWGxwRlUWQ4ywUQuE7qSRyN+PK7NbS9e48wWHq1fNsJsSCFDuFLLDL6N8zsPHf7yMYHQm/H0mxAgMBAAE=",
      "onion-key-crosscert": "DRxEoqlXrAv1xVJZsIn/AyhuKAJ/TC4CFrHFMqqRLWFb5G8U6nltFtNfrEwVlYICVZ5gx2Ik+awfLU9wUo4VdqI8162Ia1no1nsnJrbGK/3aD2FelptzjDc8SUlN6WWPbmwF1ONjBb7SVWJXMpqnpPCuTVOTyyxwEPkVi48Cp6M=",
      "ntor-onion-key-crosscert": {
        "bit": 0,
        "cert": "AQoABoosAbDWSfSvEETadS6i/IleNtvRWzkZEXj+MKorCl8efMELAHLJ8j7L/Cpi/J+orZNjKKsEEBMecpc0Gb8Is7vW8wulMwleHRUIQKqzd5OKx4RlwIc8s3Q+SjhaUe2E5K6LFwE="
      },
      "hidden-service-dir": true,
      "ntor-onion-key": "2idH2i3xcd9Ts/xswPMyTm7ksixff3ALCmfJxN1FxBI=",
      "policy": {
        "type": "exitpattern",
        "rules": [{
          "type": "accept",
          "pattern": "*:*"
        }]
      },
      "ipv6-policy": {
        "type": "accept",
        "PortList": [
          [1, 65535]
        ]
      },
      "tunnelled-dir-server": true,
      "router-signatures": {
        "ed25519": "zCUv3+n1nA22Ro2vO6g/BjlU339F28b4q1aF5Yjxy6JsxvV0x1bstdyVjYPzWBm9GN2pwKMZXGeg9OHyWVdJCA",
        "rsa": "WMT8+D0rJz8LOJZs9/qedf4nWQqABd3mSusppZIC4+YbD+FSrWXCe1tDcu9aRSIQfi2DNXmeJS35hMZRJHp1Z39emdB2u9qcZpkC1kxGUe5ZI9g3sWpknDbr5N0yqggsPLuX5FydfKIliG6MzvFd74TYJpRlmC+O1RwOD2l7KQU="
      },
      "flavor": "unflavored"
    }, {
      "digest": "F8dR5XcPim3N3L5Cpeg36EO/b8I",
      "router": {
        "nickname": "test004r",
        "address": "127.0.0.1",
        "orport": 5004,
        "socksport": 0,
        "dirport": 7004,
        "identity": "S+6sfAYBWteu31d3CgDokdOrTFg"
      },
      "identity": {
        "type": "ed25519",
        "cert": "AQQABopcAXjhc3CB7lHEg10OWU3Sfl9H+i8Fkp4EjRsG3dN975GIAQAgBADtHFtLJKFKd47FRKT6AZpjx3USfsC7HCfmakRGgRCFAmNQQbId9RcPibVvZXgrTLIqTEdJ6z9bRkRCWAQcQJnI6PMOiyPuEektymLaqNGuX1J/dwsQHc3T7J1ZKTya1QE=",
        "master-key": "7RxbSyShSneOxUSk+gGaY8d1En7Auxwn5mpERoEQhQI"
      },
      "platform": "Tor 0.3.4.8 on Linux",
      "proto": {
        "Cons": [1, 2],
        "Desc": [1, 2],
        "DirCache": [1, 2],
        "HSDir": [1, 2],
        "HSIntro": [3, 4],
        "HSRend": [1, 2],
        "Link": [1, 2, 3, 4, 5],
        "LinkAuth": [1, 3],
        "Microdesc": [1, 2],
        "Relay": [1, 2]
      },
      "published": {
        "date": "2018-10-25",
        "time": "19:41:28",
        "stamp": 1540496488.0
      },
      "fingerprint": "4BEE AC7C 0601 5AD7 AEDF 5777 0A00 E891 D3AB 4C58",
      "uptime": 0,
      "bandwidth": {
        "avg": 1073741824,
        "burst": 1073741824,
        "observed": 0
      },
      "extra-info-digest": {
        "sha1": "E3AC69A29F4D96AA8EEF3D97C369D305BE0B2A6B",
        "sha256": "Qo+8hyhSfPHZJqCPFngBfuJFERz9eXuENryL96DAEpc"
      },
      "onion-key": "MIGJAoGBAOx6+zskMR9HUsmOyp9gHC81Wmz3F3s2t6IRiRvX/a4JD69GeeLqBHUo2fcNm9IU27ijkXXSiRb1s5nYS3Q80rvSlMW5iCNkq1McDGxeZX6gYxxb9Kr1J5jffB3Ey/1XGXZQNgKNSTiujanhsc+v3dmE1Pwplqr4UAcI2d/RpIcjAgMBAAE=",
      "signing-key": "MIGJAoGBANE/jTY+w7KNPbxEj9TZmvhnN1UD63jrHK2ISV+kt4u3b/vqrcsvj8zLH4riso09h5ubRDILhQWLzapQCF0gDOC28PssLQFLghSc1gBxFGNmxhWyHQQmwWEBEE/CsRk6WnE52rMP3FA3XkJgYhqZd2DDXNU4SklXUwKchz5srVn9AgMBAAE=",
      "onion-key-crosscert": "xu8QKlauNXdcGhA4lMDE2k3LfHLhci+5mJjEgyDJYk3d6YkNmGcNwHF6j6LiEItZmgmyFYOMIRinAgQ1YgJMWBPxuktOoM89P6CAnYQ6tBBn3qi19yubHNIoQDO9wossDgZxReLECZF5ygey3Kb+uSih6+KIrWXUQAswqQeoBlo=",
      "ntor-onion-key-crosscert": {
        "bit": 0,
        "cert": "AQoABoosAe0cW0skoUp3jsVEpPoBmmPHdRJ+wLscJ+ZqREaBEIUCAFX600jdOx9t8Xy8ow/k2gRZ/NEx6XjxL43LyspwSKHSRMt7s7mCU5Har9W+n69PmpfwD6UcawFUDAwXDmZzXAU="
      },
      "hidden-service-dir": true,
      "ntor-onion-key": "BuKiy2HK44Yn/949WyOAoGMpcC3M0E5mTTbpn6IKgzw=",
      "policy": {
        "type": "exitpattern",
        "rules": [{
          "type": "accept",
          "pattern": "*:*"
        }]
      },
      "ipv6-policy": {
        "type": "accept",
        "PortList": [
          [1, 65535]
        ]
      },
      "tunnelled-dir-server": true,
      "router-signatures": {
        "ed25519": "hyCzkYwJW8ncSeO6dORm6XtYQ3DqtdvXa3b1F/C0mD0YRhyOuuqiVLT2zGnacPWkpIjRjHgfjL5yTM0cU9QPDQ",
        "rsa": "pZs07sa2kNvs09s5BAQHx/YteC+k7wICgCqm8nltOhShgm1kg7EgUWQILdqnH9yPGLW9C2AqkQAqzUr1IJv3rYuWb8HTvQUDehNtX9JyfGo6cibctPQU4EnJqQbPGVUOTxln1tOjsIikenZHStZy5sQsmLoU9mmNKX7yL8VlbpU="
      },
      "flavor": "unflavored"
    }, {
      "digest": "GRTb4ZJPqUyZ7Iz/MKZLUR4WZtA",
      "router": {
        "nickname": "test006r",
        "address": "127.0.0.1",
        "orport": 5006,
        "socksport": 0,
        "dirport": 7006,
        "identity": "VfNFSOdj1SEiy8pN3QhCuMxOXFI"
      },
      "identity": {
        "type": "ed25519",
        "cert": "AQQABopcAZr8T5xAIvOKwFGWj5bbPNc0ee1reR/KP2698S7mevddAQAgBAC9g2VafAGgtPN1Ikb37C8HJHvX35sBjyV+sJy0DmRji3NMFbjwE9TnTgRNJh+wm2WWLLaBieTKPMhzgTMxY2lun1PNr2kiOFWIQPnmRvMyX4Xa257D9Jkm9nvxzV+SrAw=",
        "master-key": "vYNlWnwBoLTzdSJG9+wvByR719+bAY8lfrCctA5kY4s"
      },
      "platform": "Tor 0.3.4.8 on Linux",
      "proto": {
        "Cons": [1, 2],
        "Desc": [1, 2],
        "DirCache": [1, 2],
        "HSDir": [1, 2],
        "HSIntro": [3, 4],
        "HSRend": [1, 2],
        "Link": [1, 2, 3, 4, 5],
        "LinkAuth": [1, 3],
        "Microdesc": [1, 2],
        "Relay": [1, 2]
      },
      "published": {
        "date": "2018-10-25",
        "time": "19:41:28",
        "stamp": 1540496488.0
      },
      "fingerprint": "55F3 4548 E763 D521 22CB CA4D DD08 42B8 CC4E 5C52",
      "uptime": 0,
      "bandwidth": {
        "avg": 1073741824,
        "burst": 1073741824,
        "observed": 0
      },
      "extra-info-digest": {
        "sha1": "580B106150342A035F4B712C8F128A7F1FDB9250",
        "sha256": "e+A/n8yMMnGEt//Hls29FPiBG6DopSbBaTthFbQkBBU"
      },
      "onion-key": "MIGJAoGBAN4GpdiOxB5ZhCSTFunbiGu0BnQaScD6MY+b4zKXS/5xTrI12xANqQQh9+v0l+Av/IOZgrkDEiEQvBnRn58IEjjqA7zxFvyYJB/6YQXI8ht9xQ5E1Jiu/Srtv4r2Q9IQvt2hiA6II36j6s1kEzonHbaz3ZUsO/kPegfdWz4NHth3AgMBAAE=",
      "signing-key": "MIGJAoGBAK9bvuj8GqrcP3h3rUki+FcaP0w/kuRpv2170XB0WTF2VhLCKxo829pAsvi9lHeQJY4oIfb8P1yP+/6axAtrLcLHKxeRGTqmjEorS3KnFXIYiPz2S2c9pOCQfH6kaAOx39bTkACZk6w2W/IVXAJ6PQi755V9FMCWcN1zMvJSh+OxAgMBAAE=",
      "onion-key-crosscert": "HxGg0bfUIpHUA2XWASgOCSZT2uWYoe+RdA9cay7dckwXcVOzVoU+BH1ogjbNof5ZCTN6Z6eh6UyFZVPtiEPpdPgD6AEgPs2uYznukY5jkENCcJcNAqiagiPw4ntTqer8PqbFkeYWpqyeFlUYP/ch9aqCzZApzl+HEcuJkOg67gs=",
      "ntor-onion-key-crosscert": {
        "bit": 1,
        "cert": "AQoABoosAb2DZVp8AaC083UiRvfsLwcke9ffmwGPJX6wnLQOZGOLADBCqckACmqKN71KzOqX1sTYRcxQAiVq7DMTUs2oxNIk3aF6UrhSI38hAU8ZHsQa6+LCPwQq1HZb330FqXgreAM="
      },
      "hidden-service-dir": true,
      "ntor-onion-key": "TRzzbeCVu+5hWRpHnAZWwojzMxfRDMUYKNmyh/lp7FI=",
      "policy": {
        "type": "exitpattern",
        "rules": [{
          "type": "accept",
          "pattern": "*:*"
        }]
      },
      "ipv6-policy": {
        "type": "accept",
        "PortList": [
          [1, 65535]
        ]
      },
      "tunnelled-dir-server": true,
      "router-signatures": {
        "ed25519": "pzsLm2dKAo1dwl9Z3HXVf7c3JUZ12MZnRMPvtFOJVgWjIsUKIKQB3dEUUJqTn+yrLzszggSf7bwMM1SLDlziCA",
        "rsa": "o7BlOSp6KgP18OqbdSekraLcmWODLpgjrnCJGAtkRcMDW6PUPiRZ/A1aAkNWiZnqmJ4/RXeCDGfZQrXXf8jP7TR1QtTO8XEG8HEKxK0ILnMjWNjw4jdK9JawHFldQ38FgGPYGJTXpklx4M0doArXy3mMgugdNRw/A2TesjSaOMc="
      },
      "flavor": "unflavored"
    }, {
      "digest": "kw5IGLfdtRyxAr3KJ2fgYsqaBAQ",
      "router": {
        "nickname": "test003r",
        "address": "127.0.0.1",
        "orport": 5003,
        "socksport": 0,
        "dirport": 7003,
        "identity": "XQMw08Sb/VuAOTFXKSdETbS95a8"
      },
      "identity": {
        "type": "ed25519",
        "cert": "AQQABopcAe6PJzFL/U5HTTAhKu7mqotxQASpXq/Wfv3xy9m2HR64AQAgBAAx0IVvkqpvPYrBnjCFJg+qFtOhYnoTw/wSJ/NcPFgZz9koHccarud0t3lN8pTmbEVGHQqx15M3ZZFWWmS3HsohbiXBV/9XYy/IdTGtS8uB1aH86J6q+RYPYMzwdcubhAk=",
        "master-key": "MdCFb5Kqbz2KwZ4whSYPqhbToWJ6E8P8EifzXDxYGc8"
      },
      "platform": "Tor 0.3.4.8 on Linux",
      "proto": {
        "Cons": [1, 2],
        "Desc": [1, 2],
        "DirCache": [1, 2],
        "HSDir": [1, 2],
        "HSIntro": [3, 4],
        "HSRend": [1, 2],
        "Link": [1, 2, 3, 4, 5],
        "LinkAuth": [1, 3],
        "Microdesc": [1, 2],
        "Relay": [1, 2]
      },
      "published": {
        "date": "2018-10-25",
        "time": "19:41:27",
        "stamp": 1540496487.0
      },
      "fingerprint": "5D03 30D3 C49B FD5B 8039 3157 2927 444D B4BD E5AF",
      "uptime": 0,
      "bandwidth": {
        "avg": 1073741824,
        "burst": 1073741824,
        "observed": 0
      },
      "extra-info-digest": {
        "sha1": "356FFD7C5D4CBC6569736968D5B8CC772A5CE5D7",
        "sha256": "JknPzuWRf3gNZE1zlmrXPqvuaiQjiBqMM3QS073VuJ0"
      },
      "onion-key": "MIGJAoGBAMWiTh3l1/lGieec01YiMkyWE4miuny9qsUT9hz6WbqjxzzZSszisGPB0fKFOrTqJFn49/8p+GmOFMDtLJBOr/9sTMRDRPywtHq4CMYyQIwmJNwNSjEYE/I9UVTFWD2W9B/KRedBJ/KJ3isbyax+jkQKw0iCPHPMJZp/J+l5ijQ1AgMBAAE=",
      "signing-key": "MIGJAoGBAKeX6vGTZquy011iL682hQSd2C0GJoumQ1jGB9BaQl1ZXhKW9LMBfvTnL1CwolkIOCBjIFkE65DNX44iLBu0/h+ajnOH9Dn0tthJ4Fnbgn8/3mh3VtTtF3Td9J7BV2AhP5C9q6UXYULYdwM8pcsm4bn2qGKsDH7OHvz7C2RWvR+hAgMBAAE=",
      "onion-key-crosscert": "OZBeVdRNQZKePyBf3al57E1u8NDsCSNK8ifR/kaZWiKOijXeNeP1YOiJSA/og0fk3wBW0azl2Ixr+Wu+cx1mSsP4paHkB4zpeQ7HOGju5VvpN+p9bQWFkVJ3C/yBg/Z2fp0ge2wq2pgyrpPD1GMttna26/goOJ8gq3C+HcHrEyk=",
      "ntor-onion-key-crosscert": {
        "bit": 1,
        "cert": "AQoABoosATHQhW+Sqm89isGeMIUmD6oW06FiehPD/BIn81w8WBnPAHeQHnwelc+egX9mGHMbg8sPFz++He5uBYfajDt8OCLUZuNgFzldYCNgn3CXff4GtlOHrB1Wm5qWwd/PbVoaPgk="
      },
      "hidden-service-dir": true,
      "ntor-onion-key": "8YojGUnvnBJ1n5KZdQ80sma2yHOiGSbX9aRYhEHdhhM=",
      "policy": {
        "type": "exitpattern",
        "rules": [{
          "type": "accept",
          "pattern": "*:*"
        }]
      },
      "ipv6-policy": {
        "type": "accept",
        "PortList": [
          [1, 65535]
        ]
      },
      "tunnelled-dir-server": true,
      "router-signatures": {
        "ed25519": "o5uLNzBMeW0/KhV7qNf1b51fj4Q99cHXgDRTsb7c+YHYCTwH9Hkg+VXFz/Ga8KgupZU64gWfykFjNZ9tkki2Bg",
        "rsa": "Yiia/oQVMmdL4LToj85rJSB5doHDCogLNGFcQaSjZVDFyHXs64osJsVu/sLU4r5rx96mBv7rT6eDs9xcRiyXR/u1qg54r6eosm2qpUjrVGuLDCLp7tB1HQu0BOfHfp/oO9tckTCOFPJNEGn4J/1PqJLfSDOOISDjEdj9ZomvCag="
      },
      "flavor": "unflavored"
    }, {
      "digest": "7f6+nxd/BcYsRhZHjoPbX08RuZE",
      "router": {
        "nickname": "test001a",
        "address": "127.0.0.1",
        "orport": 5001,
        "socksport": 0,
        "dirport": 7001,
        "identity": "YOWEQoEkmZgngDC370QiDjR7jZI"
      },
      "identity": {
        "type": "ed25519",
        "cert": "AQQABopcAWfBa1GzJoH9rRA39ut26ROTQllEqsqFb570evdc6/+xAQAgBAAvlZZk4r7Wy/A6ArGSmWCtScomi+OP3bIaOYz0CinTu0ZLq2pkhiU3/AzAJ5DWdct2ddDPOTUPDQQhUMAxPIyYXAlTQXbkykuewEwi0Z5bmvMYNE6XA6Brd5edv2w1Ews=",
        "master-key": "L5WWZOK+1svwOgKxkplgrUnKJovjj92yGjmM9Aop07s"
      },
      "platform": "Tor 0.3.4.8 on Linux",
      "proto": {
        "Cons": [1, 2],
        "Desc": [1, 2],
        "DirCache": [1, 2],
        "HSDir": [1, 2],
        "HSIntro": [3, 4],
        "HSRend": [1, 2],
        "Link": [1, 2, 3, 4, 5],
        "LinkAuth": [1, 3],
        "Microdesc": [1, 2],
        "Relay": [1, 2]
      },
      "published": {
        "date": "2018-10-25",
        "time": "19:41:30",
        "stamp": 1540496490.0
      },
      "fingerprint": "60E5 8442 8124 9998 2780 30B7 EF44 220E 347B 8D92",
      "uptime": 4,
      "bandwidth": {
        "avg": 1073741824,
        "burst": 1073741824,
        "observed": 0
      },
      "extra-info-digest": {
        "sha1": "C3CBA95BD07196713D5E3C4963BE0D578185B4DC",
        "sha256": "EfyEdsRdUwOs2R8WopF2OAR38RHcuL9RBz93KWswLKQ"
      },
      "caches-extra-info": true,
      "onion-key": "MIGJAoGBALPz2e/C5hpZ2fmVEEFXIEfjSzjzQAwmK/mVBF4XFlsxIdQdIBPuIR1fiFwkQaI4Z0QYGxu5HdE0PPXswvio1ARGImjo1BTMkCR2Y6S3Bzp+cDUO5bIxRq7CYKmNxo2soYjbYcB16SgleseEwvXw93/Kczw5ADrcKoiQ7IveTBzLAgMBAAE=",
      "signing-key": "MIGJAoGBAMLNn9Xp3FqxTLOkZDGF2l5QkNr4cenHrGFBdZ7VELITOpQsQDBNHQtKhUHH/MFv4crj5Z57YI5w9nWBNc9cIs7xbilHyNiP+Hiknfhs60ggN897zLaSSYY8zzHYYPpd6kzMA3nnXRV9HciCxWrL5vpvpTCcdufLGPQ6/jcG/ijNAgMBAAE=",
      "onion-key-crosscert": "cLG9+D4an6Os4lNg7iSGHFNk/CMRXDRWOCp3ZSVEwKdKQg44ffvPdmZ76/iJ8HG60kt5oRMu0gGAN4FNv2fJwy/0Wb4fkEDqSf59iFzA6Ksfu90yJDo0HIDMIIcdsF1PgoF8B6MZi5Hhqe2VRqUNegtfQxHntX98F43aVDIxk6Y=",
      "ntor-onion-key-crosscert": {
        "bit": 0,
        "cert": "AQoABoosAS+VlmTivtbL8DoCsZKZYK1JyiaL44/dsho5jPQKKdO7ANj4aVXfh8xgmi+i3NAg5F8Nhvmcjf44sXF+uwiuwErlDqltrN31egsGT/OssYTBIcZn4DfDxSbwwp+wgownEAU="
      },
      "hidden-service-dir": true,
      "contact": "auth1@test.test",
      "ntor-onion-key": "/7gUUvCJibZFLCEucsaAKtxN1wb8oeLiau94GQdppCE=",
      "policy": {
        "type": "exitpattern",
        "rules": [{
          "type": "reject",
          "pattern": "*:*"
        }]
      },
      "tunnelled-dir-server": true,
      "router-signatures": {
        "ed25519": "fOO4cvy8XpuJYOQKIzzMi5pbI2s9xuupZhap0syygROz+2zMiRF38eFP32XRGLA3UuSOGxVsgeHGNqLZRGuYBw",
        "rsa": "YAZrDSHiA3f9gEAuyb/lQr/AHO/FF3azxx6dL+3dBTbGXl2pFHeGj437Z9f2wzF3fi9W+UYV1LK05mrNsf4z5KKPof0XfPpBRxhOv1POiaHgh5X6/sDhhes+cUdhkCySQceY5FkwEy++jJzrZqSdNfsoTtg0b30ATplpEUCpMig="
      },
      "flavor": "unflavored"
    }, {
      "digest": "+cGCb79HD+NIHhLkTOwvA5a0kpk",
      "router": {
        "nickname": "test000a",
        "address": "127.0.0.1",
        "orport": 5000,
        "socksport": 0,
        "dirport": 7000,
        "identity": "fzSM1aLTtmTGPyI2d35ju5dqQrE"
      },
      "identity": {
        "type": "ed25519",
        "cert": "AQQABopcAW0gZjhv90GaxkQcUkmI2Ag8j3dBuMZL1XyeTzvCbMYyAQAgBAAwlJhy4UgKc/j+uuCr3KArVocUQHEvs7CoaZ26LFPmBa46M0lxJvwnxoMa6nmnn8JUx1JrTEYzUx9G7yMXP4fxXMOl59qYGHkuXwn4U8zOLIL2nNTf379g0F3ZZC+kmwE=",
        "master-key": "MJSYcuFICnP4/rrgq9ygK1aHFEBxL7OwqGmduixT5gU"
      },
      "platform": "Tor 0.3.4.8 on Linux",
      "proto": {
        "Cons": [1, 2],
        "Desc": [1, 2],
        "DirCache": [1, 2],
        "HSDir": [1, 2],
        "HSIntro": [3, 4],
        "HSRend": [1, 2],
        "Link": [1, 2, 3, 4, 5],
        "LinkAuth": [1, 3],
        "Microdesc": [1, 2],
        "Relay": [1, 2]
      },
      "published": {
        "date": "2018-10-25",
        "time": "19:41:29",
        "stamp": 1540496489.0
      },
      "fingerprint": "7F34 8CD5 A2D3 B664 C63F 2236 777E 63BB 976A 42B1",
      "uptime": 2,
      "bandwidth": {
        "avg": 1073741824,
        "burst": 1073741824,
        "observed": 0
      },
      "extra-info-digest": {
        "sha1": "CBD05F8DF79A887DD4DE719DD88FF8F68910DAE3",
        "sha256": "gZfisJPqJv4zi0hHKw5r2DnkKxtHIbPxdRRq27TOhEU"
      },
      "caches-extra-info": true,
      "onion-key": "MIGJAoGBAMPDaI2woprvzlgha2qo+mApbL/CuIS7/rdKCI96q3yyIM2qXUsryxNW0NTIR8IHvXdy5vCp8srH8s/pCJ0Ll7+EI9sWbtH2Urrem1iilY3QyZm494t5IcG40ncjcfkQoy9BGOwbi1QgHQSRR8oxDiqJPeHUfglHZI8MjBXX7oWZAgMBAAE=",
      "signing-key": "MIGJAoGBALGAf+sHmHwi/Xv2bny7Kof5QHNjXvrxhR2+TGf+O2I8olYe4W/VWZ8/r/7bhODp0DmQDW/5pIHug8QSMVCJZ6DCVYM6tKViu0VwmwbvuS/Q154litZlHBH+JedaZAOJLdpmTG9fP835tROseI2kHkue6x78h5ZcxkrD6IBYbMcRAgMBAAE=",
      "onion-key-crosscert": "PruRwAVrx9sTwxS00SApzQDaF/wYb8FsALxOWk4B4S9uNdol/Roa0lU4pIEM1SH8fgd3x7sefo7HOPON++/n8EtJpGcyIW5oL9DRL+I0TKx9G9WlVaBRWmCTW52nMOf+xKyfrYZu7DZjYPy8Y+Z7v48cJQ+iOUChfyYNzO1niR8=",
      "ntor-onion-key-crosscert": {
        "bit": 1,
        "cert": "AQoABoosATCUmHLhSApz+P664KvcoCtWhxRAcS+zsKhpnbosU+YFANYaPWA4A1PMzE9CUXsdA/v99hASI3A2G396qBNaeq53EkLo2T1bnFDVkhxbPNl40WrhvEOny67/2/T78Px0VAU="
      },
      "hidden-service-dir": true,
      "contact": "auth0@test.test",
      "ntor-onion-key": "lwKx+Z1IDq968KxwW46pxsyoRIYsUc/fPEyt2SiTgyE=",
      "policy": {
        "type": "exitpattern",
        "rules": [{
          "type": "reject",
          "pattern": "*:*"
        }]
      },
      "tunnelled-dir-server": true,
      "router-signatures": {
        "ed25519": "ai2OS7r3uD/0UfhITd5QvCzyqy1nkHzKoN0lcR/zCinW7FncKJwHZqExHBR+GgieNb0VJelGHgG9tbKKdnPJAA",
        "rsa": "NfxnxwkJOxQthKiioAcwqNLYHBQd5ZtY8aXH7hcWTW2LcPDYeL9z4je/dLFP1T6a2esg1UvUbKHpNr82WM9Z7yGeGeQ9ND+yMa7lTGWmZSE1DP/rlwaKwCfoECpucuvtSh9SFy0jJvXhAbNO1qz0umnER/tFX390rAC8DoLNm7s="
      },
      "flavor": "unflavored"
    }, {
      "digest": "si50Xh4W3+PyJa/cRyfVWTFJQCY",
      "router": {
        "nickname": "test007r",
        "address": "127.0.0.1",
        "orport": 5007,
        "socksport": 0,
        "dirport": 7007,
        "identity": "tKw6dCiiPFHfX6xTcFdNuHwWwjA"
      },
      "identity": {
        "type": "ed25519",
        "cert": "AQQABopcAUN4++NI3YbEBluUlfekAPfGAfWcD6YKxx6yQcLnOgxJAQAgBADUnJUW82TDIyOJvSyKFEJGzDDDmzicLmWhQlbPIHnCGV9u5pYIRs9IcUMX9p18bRB4mQhPWCFmdQ6BCv+aQKXt+Rxd3VkPnyggk03CpHIzMuflTWltSkKr6VgAkuoctQ4=",
        "master-key": "1JyVFvNkwyMjib0sihRCRswww5s4nC5loUJWzyB5whk"
      },
      "platform": "Tor 0.3.4.8 on Linux",
      "proto": {
        "Cons": [1, 2],
        "Desc": [1, 2],
        "DirCache": [1, 2],
        "HSDir": [1, 2],
        "HSIntro": [3, 4],
        "HSRend": [1, 2],
        "Link": [1, 2, 3, 4, 5],
        "LinkAuth": [1, 3],
        "Microdesc": [1, 2],
        "Relay": [1, 2]
      },
      "published": {
        "date": "2018-10-25",
        "time": "19:41:28",
        "stamp": 1540496488.0
      },
      "fingerprint": "B4AC 3A74 28A2 3C51 DF5F AC53 7057 4DB8 7C16 C230",
      "uptime": 0,
      "bandwidth": {
        "avg": 1073741824,
        "burst": 1073741824,
        "observed": 0
      },
      "extra-info-digest": {
        "sha1": "74248A277F34F515643333EC0EE41C4528E7D7E4",
        "sha256": "+50h8d3QbPcIriU4Wg+8pYflIsO9YF+yNxnmF4SUJvQ"
      },
      "onion-key": "MIGJAoGBALxyLNJCypCQ/hrvydzdSdkGXkYqLnBWIY/70JaU4b373UuuXsfh6K3d5B4TuTa3QlpefnUGvTMcPRUP0UGRHjXfcAJkQAqIzxCRXGQgKrGLGH2ZA31u7eAjqgE92jEtygcdMDIbKRiMGCfHAp6vJOnmcnlM5XPdHdZJk6BulDsVAgMBAAE=",
      "signing-key": "MIGJAoGBAMKvFNNhJDriOgL/qpijYK+M+j05R0pBgTYLaDUq3GSJY1nqDvP4VsQMYqTaLyWPMTAhQI0iUTfB59m2rQoMEPnPOvBQRgZoLwtpSA5ZbA0dk++wuVnq7NXITmis7VzMGiAZRs33QM10f7r6GAg98jNWbCi1U5pcnbCO5aGJ7+TvAgMBAAE=",
      "onion-key-crosscert": "nuv1cVVNAwyXWrrFjmFBV2Igr/4t7EcHcVl3ALPWt7o2v61nNjQIAV3h8yyRUQsIZL1tm3UW34mj1g2Ld0FQKi1eskIm1/DohgGieHLk5bt19AJRb+5ucxlkj7leZ/lGxhfEhPr1wdJpGe3jstACnTf53I7LCRpQ/1p+6QzR3Ec=",
      "ntor-onion-key-crosscert": {
        "bit": 0,
        "cert": "AQoABoosAdSclRbzZMMjI4m9LIoUQkbMMMObOJwuZaFCVs8gecIZANjdpz2uJEfyoi7OuoClnCcqZFTmDcRNdV8d9ELW2d/NbxVnAOUvgqSudiDh3Y/NRIiJpl5IOfPaP7t4ifsFbgs="
      },
      "hidden-service-dir": true,
      "ntor-onion-key": "Wfmb6oT8jt8D5bawkTKGiDmu2G9WrfpgDZEzP9Rodj4=",
      "policy": {
        "type": "exitpattern",
        "rules": [{
          "type": "accept",
          "pattern": "*:*"
        }]
      },
      "ipv6-policy": {
        "type": "accept",
        "PortList": [
          [1, 65535]
        ]
      },
      "tunnelled-dir-server": true,
      "router-signatures": {
        "ed25519": "qSWGQVbdPIcMUfpClawJhTsJOEGXBPNnG9GYPNQ6ESzonMjnGuK78uk6T2UF9bhKOI09kLrAsSvzeX2rA8XkDg",
        "rsa": "oXA0zPfKWF1SDLDd1KTNlvnVL6LOFFOqxR6WVwjw2FKYX5XHS7kixkwhMthaGJc3PS79n70TbULXCAHJhHxh6foBbg34NVIYJF8Sm7KLBMywGJZUJEDqHgIr2VxdL5SMy4pTsyXvqMYjqCoh/u6yssbJEYaGKFoANbrw0o+p1sI="
      },
      "flavor": "unflavored"
    }, {
      "digest": "hLAik+8aXahHR2ifdfv6+4aZtZg",
      "router": {
        "nickname": "test002a",
        "address": "127.0.0.1",
        "orport": 5002,
        "socksport": 0,
        "dirport": 7002,
        "identity": "xH9tKK6u1BLxrB4xHrFHbmuzd5k"
      },
      "identity": {
        "type": "ed25519",
        "cert": "AQQABopcAdqOzm4tsrK1uMSOF9JpOzul0VrGxNgP2B4YZKZsUJdUAQAgBACzswrcGbGOw5cR4iSCJwLmHWoIgd8SDueQhGYkP/CqOaqjAyHxZ30i6okUgmO4B1chr/OB14Zlm8Z4nNft5reNDmqxrKNKqF9+SeviS0NtIo1WvBHlBwAqHBHHpEeHJww=",
        "master-key": "s7MK3BmxjsOXEeIkgicC5h1qCIHfEg7nkIRmJD/wqjk"
      },
      "platform": "Tor 0.3.4.8 on Linux",
      "proto": {
        "Cons": [1, 2],
        "Desc": [1, 2],
        "DirCache": [1, 2],
        "HSDir": [1, 2],
        "HSIntro": [3, 4],
        "HSRend": [1, 2],
        "Link": [1, 2, 3, 4, 5],
        "LinkAuth": [1, 3],
        "Microdesc": [1, 2],
        "Relay": [1, 2]
      },
      "published": {
        "date": "2018-10-25",
        "time": "19:41:31",
        "stamp": 1540496491.0
      },
      "fingerprint": "C47F 6D28 AEAE D412 F1AC 1E31 1EB1 476E 6BB3 7799",
      "uptime": 4,
      "bandwidth": {
        "avg": 1073741824,
        "burst": 1073741824,
        "observed": 0
      },
      "extra-info-digest": {
        "sha1": "6ADE0F560FD93546CF130150DF1E3A578D2CF532",
        "sha256": "wBMBRe1UPu2mFXblwjf7EM9kBsEvTqAfpyOT4+nGY5Y"
      },
      "caches-extra-info": true,
      "onion-key": "MIGJAoGBAMO8kLV04qdCoQzR7XOBAlxwT9LDEcXPeCATDlukwr/r2eg23NuNOY7koEkDVxeK3AlifxTfg3jFFrYFKVV2cNCcda9+DszmdV8RYCxOCSnboO//4WA9CgiRadh3IuLX6La5976TmwxeXwhdR9Dc5Bi1siictJD+cGx3dwicDGhlAgMBAAE=",
      "signing-key": "MIGJAoGBANr3BdtAuXxfRbaJej06jkmZr/eUC1b0aLwk0WBtM/4d9I14mE3eSfhv0TQsHKl2IV9w9CzBhVxPFuxVN9GjjV5Of8/eFO8i94qXOcfMtOBm1T4iSCT7wUAawoF39PGjxoljx//CxYz/UjFpieKmFuljv8rNRdGru93S65ZkIB+FAgMBAAE=",
      "onion-key-crosscert": "mtEJ+8MF1jZuhEF3+QFXQdM/551aCM29gazYtLLiYDhyvcSoX2IdDDnV/idkkG6uTn3KZB2/HokxC7ZV0RjPEYWicb5RsDvCsYP7hH3+FhDUPXPqaPn4UNjwiUchHSgONmMEf/tfbt6NaGL3/p04FETgH9B+HgJERVQZtHAFgfU=",
      "ntor-onion-key-crosscert": {
        "bit": 1,
        "cert": "AQoABoosAbOzCtwZsY7DlxHiJIInAuYdagiB3xIO55CEZiQ/8Ko5AMrnVGCoEP+OiJ8vPJinX4lm2VTIBSVKeuBLJVnUxUYS0juSuTMbSdLf6ycnAekiF8CDo07PJTQiJbyDxBcSwgU="
      },
      "hidden-service-dir": true,
      "contact": "auth2@test.test",
      "ntor-onion-key": "sl+rGxQz4UObT5PAIyC14FH5kki9FD1JikVjwDZ50Q4=",
      "policy": {
        "type": "exitpattern",
        "rules": [{
          "type": "reject",
          "pattern": "*:*"
        }]
      },
      "tunnelled-dir-server": true,
      "router-signatures": {
        "ed25519": "q7gD1Hnt9tNGQTUHI0eObKDRBLWO/EYMLXDVN130rJlKM39GuyIm2edlzSFhGZ0fX4GBplogzIPsq/TIOGBvBw",
        "rsa": "G4WE6bBK2aeA5WI3b7LZnvkXqoRvojyYCvtgeeyd3Jb3nEjxQFhoBWKqNcIIQJ0EG1kjfpv45sdHt/AD3y5FzRZU03O/8DruWRurBFAC30wGUPy7v1FUytf8ky+CCBaVVMTXOS9zN3/4kwouBBDdXa5TCI3S2+Mu77KG33Rar+Q="
      },
      "flavor": "unflavored"
    }]
  </script>
</body>

</html>
